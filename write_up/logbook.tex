\documentclass[a4]{report}
\def\atitle{Logbook}
\def\myname{Christopher Boyle}
\def\mon{\subsection*{Monday}}
\def\tue{\subsection*{Tuesday}}
\def\wed{\susbection*{Wednesday}}
\def\thu{\subsection*{Thursday}}
\def\fri{\subsection*{Friday}}

% Preamble
\usepackage{graphicx}
\usepackage{geometry}
\usepackage[hidelinks]{hyperref}
\geometry{top=2cm, bottom=2cm, left=3cm, right=3cm}

\begin{document}
	\begin{titlepage}
		\makebox[\textwidth][c]{\includegraphics[scale=1]{images/titleheader.png}}
		\centering
		\vskip4cm
		{
			\bfseries\Large
			Department of Chemical \& Process Engineering\\
			\vskip1cm
			MEng in Chemical \& Process Engineering\\
			18530
			\vskip3cm
			\LARGE\atitle
		}
		\vskip3cm
		\begin{flushleft}
			\vskip3cm
			Your name: \myname \hfill Date: \today
			\vskip1cm
			Organisation: University of Strathclyde, Department of Chemical \& Process Engineering\newline% \newline
			In-house Supervisor: Dr. Leo Lue \newline% \newline
			Academic Supervisor:  Dr. Leo Lue
		\end{flushleft}
	\end{titlepage}
	
	\tableofcontents
	
	\chapter{December 2016}
	\section{Week Beginning 5 December 2016 (Week -5)}
	\begin{itemize}
		\item Went to meet with Dr. Lue to discuss the details of the LL3 research project. 
		\item Begun preliminary research on colloidal suspensions, jamming, using the Raspberry Pi, electronic circuits.
	\end{itemize}
	\section{Up to Week Beginning 9 January 2017 (Weeks -5 to 0)}
	\begin{itemize}
		\item Christmas break
		\item Continued background reading and research. 
		\item Begun work on python scripts.
		\item Begun writing the web control interface.
		\item Begun learning how to use \LaTeX
		\item Begun writing basic structure and format of report.
	\end{itemize}
	\chapter{January 2017}
	\section{Week Beginning 9 January 2017 (Week 0)}
	\begin{itemize}
		\subsection*{Monday}
		\item Met with Dr. Lue.
		\item Had a tour about the lab, looked at the hardware that would be used.
		\item Discussed what steps should first be taken (focus on how to detect the motor's speed), and the format of contact (regular email contact, meetings as necessary).
		\item Discussed methods of calibrating the motor speed detector (relating speed to voltage, torque to current, etc)
		\item Found a method for speed detection using magnets and a Hall Effect sensor.
		\subsection*{Wednesday}
		\item Dr. Lue postulated another method for detecting the speed using a light sensor, some reflective material mounted on the rotating cylinder and a laser.
		\subsection*{Friday}
		\item Discovered a simple electronic circuit using a potentiometer/voltage-divider and a transistor to control the voltage being supplied to the motor (to control the speed)
		\item Implemented a scaled-down prototype version of the speed control circuit, it seemed to work well.
		\subsection*{Saturday}
		\item Attempted to implement a full scale version of the speed control circuit, but was unable to accurately solder the digital potentiometer due to its size (around 3mm x 1mm). Alternative component sought.
	\end{itemize}
	\newpage
	\section{Week beginning 16 January 2017 (Week 1)}
	\begin{itemize}
		\subsection*{Monday}
		\item Met with Dr. Lue and Dr. Haw, RE motor speed control.
		\item Discussed different methods of calibrating the motor, decided to use a reference fluid to test how well the RPi system works vs a commercial rheometer.
		\item  To do this week: fill out risk assessment, find out more about the Hall Effect sensor as a means to detect speed, set up speed control and speed detection circuit, and get it working with the pi.
		\subsection*{Tuesday}
		\item Found problem with the hall effect sensor: magnetic field in single small magnet not enough to trigger it. Two magnets required, possible creating problems when fitting later on?
		\item Hall effect sensor not working properly with the raspberry pi - it is pulling down the pin voltage too far: the RPi cannot sense the signal.
		\item Dr. Lue gave me some smaller magnets, will test these with the hall effect sensor.
		\item Drew up draft risk assessment for working in the lab.
		\item Fixed problem with hall effect sensor circuit (by adding a transistor)
		\item Hall sensor is triggered when a magnet's south pole comes within 10mm of the sensor.
		\item To do tomorrow: go into lab and test speed sensor with the actual motor, check motor class is working properly.
		\subsection*{Wednesday}
		\item New digital potentiometer arrived and tested, updated dig\_pot class to reflect the new hardware
		\item Preliminary testing of the new equipment showed it works as expected, some tweaking to the resistor values necessary to change the voltage range accross the motor. 
		\item Ready to test on actual process motor!
		\item Added description of how the hall effect sensor circuit works to the report draft.
		\subsection*{Thursday}
		\item Continued background reading on the DST/Jamming phenomenon.
		\item Wrote scripts to automatically discover the maximum and minimum speeds of the motor and also to perform a step test on the motor system - this allows a model of the control process to be produced enabling a simulation of the system to be used to tune the controller.
		\subsection*{Friday}
		\item Continued background reading.
	\end{itemize}
	\newpage
	\section{Week beginning 23 January 2017 (Week 2)}
	\begin{itemize}
		\subsection*{Monday}
		\item Finalised risk assessment, Emailed to Jim Murphy
		\item Continued reading (DST, Dilation, refractive index matching)
		\subsection*{Tuesday}
		\item Wrote a script to automatically tune the PID controller (using a model of the process)
		\item Handed in risk assessment to JM
		\item Discussed the experiment and build up with Jim Murphy. He made some suggestions about the logistics and emphasised the safety procedures required for working in the lab.
		\item Tested motor speed detection circuit in the lab, works fairly well but doesn't go as low as it should. It reaches full swing after only 30 steps (not 127). Where am I losing resolution?
		\subsection*{Wednesday}
		\item Re-tested digital potentiometer, the pot sweeps from 0R to 8.9kR as expected. The circuit, however, does not provide the desired voltage for the motor. It reaches a maximum of 7-8v and then only falls as low as 5v after 30 steps, staying at 5v for the remaining ~90 (as yesterday).
		\item Looking at alternative circuits/components.
		\item Asked Dr. Lue for help with the circuit issue
		\item Begun a COSHH form for the soldering activity in the lab (need more information to finish)
		\item Looked into possible alternative speed control circuits if the digital potentiometer circuit won't work
		\subsection*{Thursday}
		\item Found out why the control circuit isn't working correctly! The digital potentiometer can only handle voltages within its supply range, so a voltage of 12v is way out of range.
		\item New design for the circuit using an operational amplifier has been found and will be tested tomorrow.
		\subsection*{Friday}
		\item Finished COSHH form, submitted for approval
		\item Filled out forms S1 and S2
		\item Motor speed control circuit fixed and complete!
		\item Now to calibrate and check the speed detection circuit
	\end{itemize}
	\newpage
	\section{Week Beginning 30 January 2017 (Week 3)}
	\begin{itemize}
		\subsection*{Monday}
		\item Due to a dentist appointment, I was not able to be in Glasgow today. Worked from home.
		\item Looked at methods for calibrating the speed sensor.
		\subsection*{Tuesday}
		\item Read some literature on Taylor-Couette flow/Couette Cells
		\item Looked at different method of using light to measure speed - similar to the way a mouse wheel recognises movement using an IR LED and a photo-transistor
		\item Ran potval/voltage calibration on motor, checked voltage range - it is indeed from 10.5v to <4.5v which is perfect. Ready to build a working prototype of the board
		\item Noticed the rotor was off centre slightly. Tried to fix by tightening and re-tightening the screw which holds the rotor to the motor, but no success.
		\item The rotor will need to be fixed before the experiment can be begun (and should be fixed before testing/fitting the hall effect sensor). Solutions:
		\subitem New cylinder, new set, new motor?
		\subitem Re-set the current cylinder in new lump of epoxy/aroldite/whatever
		\subsection*{Wednesday}
		\item Looked at ways of reading in electrical power sent to the motor (used to calculate the Torque load on the motor)
		\item Meeting with Dr. Lue, Dr. Haw, and Aditi.
		\subsection*{Thursday}
		\item Showed Aditi around the lab, discussed:
		\subitem How the hardware works (will work)
		\subitem How the readings taken can be used to gain better understanding of the jamming process
		\subitem What the next steps are
		\subitem What is needed of the standard solutions (glycerol+water/cornflower+water)
		\item Tried to fix the centring of the motor, to no avail. Need to fix it or this equipment cannot be used, other equipment possible?
		\item Spoke to Jim, new inner cylinder is going to be made (such that it will be on centre this time)
		\item Ran an initial motor speed calibration test (will have to be re-run with the new inner cylinder)
		\item Noticed the speed is off - roughly a factor of a 100 - is this the measurement or the calculation?
		\subsection*{Friday}
		\item Was given a tutorial on using the rheometers in the microfluidics lab (by Andreia)
		\item Re-wrote a section of the speed calculation script:
		\subitem New method of calculating speed (more instant, less average)
		\subitem Logs more information for better debugging
	\end{itemize}
	\chapter{February 2017}
	\section{Week Beginning 6 February 2017 (Week 4)}
	\begin{itemize}
		\subsection*{Monday}
		\item Tried to use the ADC to check the waveform of the Hall effect sesnor (to diagnose why it isn't working correctly)
		\item ADC has issues reading from the hall effect sesnor (it shouldn't). Should be a software issue, so debugged code. Will test tomorrow.
		\item (difficult to debug and test at the same time due to the lack of internet in the lab :/ )
		\item Tested new speed detection algorithm - seems to work better (gives, mostly, more accurate results) but is \textbf{very} noisy
		\item Waiting on the ADC being fixed to be able to properly diagnose the hall problem (hopefully tomorrow)
		\subsection*{Tuesday}
		\item The ADC seems to be working, not had an issue with it and the new code this morning.
		\item The hall effect sesnor doesn't seem to be giving out a regular waveform - resulting in very noisy speed data.
		\item (See "hall\_sensor\_not\_working.png" in "pi\_rheo\_proj/write\_up/images")
		\item Something is interfering with the operation of the hall effect sensor, will try using an optical sensor instead.
		\item Spent some time (read: hours) trying to figure out what might be going wrong on the software side of things, couldn't see a solution.
		\item Ordered a light based sensor to see if it was the hall sensor which was faulty (should arrive tomorrow)
		\subsection*{Wednesday}
		\item Waiting on package to arrive
		\item (Re) reading lit on shear thickening mechanisms and effects
		\item Retested hall effect sensor (logged a more complete idea of what is going on) 
		\item Light sensor not arrived yet.
		\item spent time processing the logged data and attempting to find out what is going wrong.
		\subsection*{Friday}
		\item Found an interesting paper going into detail about the causes of shear thickening (how it occurs etc)
		\item Had another look at why the speeds are being calculated differently, no avail. Will try the new method this afternoon.
		\item A third method of calculating the speed will be tried and compared with the other methods.
		\item The current sensor will be tested. Briefly tried last night, it didn't seem to be giving out the expected signal.
		\item Will also take a video of the motor to try to confirm what the actual speed is.
	\end{itemize}
	\newpage
	\section{Week Beginning 13 February 2017 (Week 5)}
	\begin{itemize}
		\subsection*{Monday}
		\item Tried the light based sensor to detect the speed; worked much better than the hall sensor. Still noisy output, but much smoother and both speed calculation methods agree. 
		\item Will need to vary parameters to improve the response. (Tuning the sensor?)
		\subsection*{Tuesday}
		\item Tested the speed algorithm parameters, varied through several values to see how this effects the speed
		\item used a "slow motion" camera to film the motor to obtain it actual speed (by counting revolutions manually)
		\subsection*{Wednesday}
		\item Recorded real time responses from the light sensor, formed histograms and compared the light sensor data to the hall effect sensor data.
		\subsection*{Thursday}
		\item Fixed sections of code
		\item Added a (possible) fix for the noisy speed recog
		\item Polished code (better variable naming, better commenting --> easier debugging)
		\item Added another script for debugging
		\subsection*{Friday}
		\item Discovered a possible reason for why the histograms are not correct, the time is saved as a 2dp number, therefore losing accuracy. This has now been rectified.
		\item (GPIO wait) Fix does not work, cannot have two events associated with the same gpio pin.
		\item Logged some data to try to re-evaluate the sensor interval timings, forgot to log the correct data. Thoroughly frustrating. Will go back down to the lab this afternoon.
		\item Noticed an error in code preventing the correct data from being logs, have fixed but now test will have to wait for Monday.
	\end{itemize}
	\newpage
	\section{Week Beginning 20 February 2017 (Week 6)}
	\begin{itemize}
		\subsection*{Monday}
		\item Re-logged interval data
		\subsection*{Tuesday}
		\item after closely examining the logged data, noticed that at \textbf{low} speeds the sensor was failing to pick up rotations (no new rotations in 9s at PV=128 - not possible. speed at PV=128 is ~30RPM, rotation every other second at least)
		\item taking one final look at the current set up (maybe there's a crossed wire? Maybe plugged into the wrong area? I haven't considered a wiring issue before)
		\item Double checked the hardware; replaced potentially faulty wire, re-seated transistor in slot.
		\item No joy. Speed reading still jumps a lot, lots of noise (30kRPM range in values, +/- >100\%)
		\item I cry.
		\item New plans:
		\subitem Use dynamo motor to get speed
		\subitem If (after testing) that fails, maybe ignore speed detection entirely? - Just log power to motor and use potval to figure speed (assuming it is constant!)
		\subsection*{Wednesday}
		\item Tried the dynamo speedometer, good results! easy to calibrate (roughly: speed = measured voltage * ~26000, not final version)
		\item Tested using a semi temporary set up utilising a lid from a coffee pot and a rubber band. Will invest in a new motor and ADC set up following further testing to see if it is indeed suitable.
		\thu
		\item After experiencing issues with the \(I^2C\) ADC (and simple success with the SPI digpot), an SPI ADC was purchased.
		\item New ADC (MPC3008) has an external voltage reference - can be set at what is relevant and will measure a voltage up to this reference voltage
		\item Adapted adc.py to deal with new ADC, and motlib.py to recognise the new (dyno) method of speed detection
		\item Re-wired circuit to make better use of space, went to test new motor set up and prompty broke the digital potentiometer (I had the power in backwards)
		\item Much frustration - there is little to do before the DP can be replaced (tomorrow hopefully)
		\fri
		\item TODO:
		\item Installed and tested new ADC - works a charm. External reference voltage makes things much easier (plus 8 channels and single ended inputs!)
		\item Installed replacement potentiometer - found out I ordered a rheostat instead. Rheostat in a potential divider results in an inverse parabolic response.
		\item Sigh. Will do for now, 'nother potentiometer, on the way.
		\item Pulley too large, dynamo is too slow at low motor voltages, input is too noisy. Smaller pulley required.
	\end{itemize}
	\newpage
	\section{Week Beginning 27 February 2017 (Week 7)}
	\begin{itemize}
		\mon
		\item TODO:
		\subitem Wire up current sensor, condition output to be suitable for ADC reading.
		\subitem (Hopefully) Pot will have arrived, although unlikely. H
		\subitem Talk Aditi through the electronics

	\end{itemize}
	\newpage
	\chapter{Considerations/To-do list}
	\begin{itemize}
		\item calibrate motor speed control circuit (ie get min speed, max speed, and speed(voltage))
		\item test that speed is being detected properly (use reference tachometer/second method to detect the speed (record a video of the motor spinning? Is that acceptable?))
		\item peclet number?
		\item wall slip?
		\subitem wall slip is often avoided by "roughening" the walls of the viscometer
		\subitem even if the fluid slips, this gives useful information about the fluid (although this data cannot be used to give viscosity, that would not be sensible)
		\subitem slip is less likely to occur in molecular fluids (water, glycerol) and more likely to occur in suspensions of colloids/granules (as particles get bigger, the surface (e.g. glass) is less "grippy" - its relative roughness decreases)
		\item noise in circuit?
		\item voltage is spd
		\item current is torque
		\item density matching
		\item refractive index matching
		\item test control system working
		\item calibrate motor control
		\item correlate shear stress/rate with voltage/rotation/current
		\item check rpi results against rheometer results for different mixtures of glycerol and water (check it works at high and low viscosities)
	\end{itemize}
	
\end{document}